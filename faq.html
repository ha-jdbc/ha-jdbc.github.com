<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Oct 4, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20121004" />
    <meta http-equiv="Content-Language" content="en" />
    <title>HA-JDBC - Frequently Asked Questions</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://ha-jdbc.sourceforge.net" id="bannerLeft">
                                                                                                <img src="images/logo.png"  alt="HA-JDBC"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-10-04</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 2.1.0-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">About</li>
                                
      <li>
    
                          <a href="index.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                  
      <li>
    
                          <a href="doc.html" title="Documentation">
          <i class="none"></i>
        Documentation</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>FAQ</a>
          </li>
                  
      <li>
    
                          <a href="build.html" title="Building">
          <i class="none"></i>
        Building</a>
            </li>
                  
      <li>
    
                          <a href="https://github.com/ha-jdbc/ha-jdbc/downloads" class="externalLink" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                  
      <li>
    
                          <a href="http://sourceforge.net/projects/ha-jdbc/forums" class="externalLink" title="Forums">
          <i class="none"></i>
        Forums</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                              
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                        
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- HA-JDBC: High-Availability JDBC
	Copyright 2010 Paul Ferraro
	
	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU Lesser General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.
	
	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU Lesser General Public License for more details.

	You should have received a copy of the GNU Lesser General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>. --><div class="section"><h2><a name="top">Frequently Asked Questions</a><a name="Frequently_Asked_Questions"></a></h2><p><b>Dependency FAQs</b></p><ol style="list-style-type: decimal"><li><a href="#jgroups">JGroups FAQ</a></li><li><a href="#quartz">Quartz FAQ</a></li></ol><p><b>Configuring HA-JDBC</b></p><ol style="list-style-type: decimal"><li><a href="#notify-deactivate">How do I configure HA-JDBC to notify me when a database is deactivated?</a></li><li><a href="#connect-params">I need to pass additional parameters to my JDBC driver.  How can I specify these in my HA-JDBC configuration?</a></li><li><a href="#jndi">How can I specify JNDI environment properties to my HA-JDBC DataSource configuration?</a></li></ol><p><b>Using HA-JDBC</b></p><ol style="list-style-type: decimal"><li><a href="#out-of-memory">I get a java.lang.OutOfMemoryError when synchronizing a failed cluster node.  Why?</a></li><li><a href="#session-failover">How can HA-JDBC be leveraged to improve database-driven HTTP Session failover?</a></li><li><a href="#local-state-manager">HA-JDBC remembers which databases were inactive even after I restart my JVM.  Where is this state recorded and how do I clear it?</a></li><li><a href="#authentication">
				Why does my application need to specify a username and password when making database connections through HA-JDBC when the necessary authentication information is already specified in its configuration file?
			</a></li></ol></div><div class="section"><h2>Dependency FAQs<a name="Dependency_FAQs"></a></h2><dl><dt><a name="jgroups">JGroups FAQ</a></dt><dd><a class="externalLink" href="http://community.jboss.org/wiki/JGroupsFAQ">http://www.jgroups.org/javagroupsnew/docs/faq.html</a><p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="quartz">Quartz FAQ</a></dt><dd><a class="externalLink" href="http://www.quartz-scheduler.org/docs/faq.html">http://www.opensymphony.com/quartz/wikidocs/FAQ.html</a><p align="right"><a href="#top">[top]</a></p></dd></dl></div><div class="section"><h2>Configuring HA-JDBC<a name="Configuring_HA-JDBC"></a></h2><dl><dt><a name="notify-deactivate">How do I configure HA-JDBC to notify me when a database is deactivated?</a></dt><dd>
				Use your logging facility.  HA-JDBC generates an ERROR level log message when it automatically deactivates a database.
				If you use Log4J, configure an SMTP appender for the &quot;net.sf.hajdbc&quot; logger.<br /></br>
				If you use java.util.logging, configure an <a class="externalLink" href="http://smtphandler.sourceforge.net/">SMTPHandler</a> for the &quot;net.sf.hajdbc&quot; package.
			<p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="connect-params">I need to pass additional parameters to my JDBC driver.  How can I specify these in my HA-JDBC configuration?</a></dt><dd>
				<p>
					The <tt>database</tt> element may contain any number of <tt>property</tt> elements.
					HA-JDBC will pass these properties through to the Driver.connect(String url, Properties info) method of the underlying JDBC driver.
				</p>
				<p>e.g.</p>
				<div class="source"><pre class="prettyprint linenums">
&lt;cluster ...&gt;
  &lt;database id=&quot;...&quot;&gt;
    &lt;url&gt;jdbc:postgresql:database&lt;/url&gt;
    &lt;property name=&quot;ssl&quot;&gt;true&lt;/property&gt;
    &lt;user&gt;postgres&lt;/user&gt;
    &lt;password&gt;XXXX&lt;/password&gt;
  &lt;/database&gt;
&lt;/cluster&gt;
</pre></div>
				<p>
				</p>
				<p>
					Alternatively, many JDBC drivers accept properties appended directly to the url.
				</p>
				<p>e.g.</p>
				<div class="source"><pre class="prettyprint linenums">
&lt;cluster ...&gt;
  &lt;database id=&quot;...&quot;&gt;
    &lt;url&gt;jdbc:postgresql:database?ssl=true&lt;/url&gt;
    &lt;user&gt;postgres&lt;/user&gt;
    &lt;password&gt;XXXX&lt;/password&gt;
  &lt;/database&gt;
&lt;/cluster&gt;
</pre></div>
			<p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="jndi">How can I specify JNDI environment properties to my HA-JDBC DataSource configuration?</a></dt><dd>
				<p>
					The <tt>datasource</tt> element may contain any number of <tt>property</tt> elements.
					HA-JDBC will pass these properties into the InitialContext(Hashtable env) constructor.
				</p>
				<p>e.g.</p>
				<div class="source"><pre class="prettyprint linenums">
&lt;cluster ...&gt;
  &lt;datasource id=&quot;...&quot;&gt;
    &lt;name&gt;jdbc/database&lt;/name&gt;
    &lt;property name=&quot;java.naming.factory.initial&quot;&gt;org.jnp.interfaces.NamingContextFactory&lt;/property&gt;
    &lt;property name=&quot;java.naming.factory.url.pkgs&quot;&gt;org.jboss.naming:org.jnp.interfaces&lt;/property&gt;
  &lt;/datasource&gt;
&lt;/cluster&gt;
</pre></div>
				<p>
					Alternatively, these properties may be specified in an jndi.properties application resource file.
					Details <a class="externalLink" href="http://java.sun.com/j2se/1.5.0/docs/api/javax/naming/InitialContext.html">here</a>.
				</p>
			<p align="right"><a href="#top">[top]</a></p></dd></dl></div><div class="section"><h2>Using HA-JDBC<a name="Using_HA-JDBC"></a></h2><dl><dt><a name="out-of-memory">I get a java.lang.OutOfMemoryError when synchronizing a failed cluster node.  Why?</a></dt><dd>
				<p>
					This can occur if your database contains a table with more rows than can be fetched into memory at once.
					Both the differential and full synchronization strategies have a <tt>fetchSize</tt> property that control the number of rows that are fetched at a time.
				</p>
				<p>e.g.</p>
<div class="source"><pre class="prettyprint linenums">
&lt;sync id=&quot;diff&quot; class=&quot;net.sf.hajdbc.sync.DifferentialSynchronizationStrategy&quot;&gt;
  &lt;property name=&quot;fetchSize&quot;&gt;1000&lt;/property&gt;
&lt;/sync&gt;
</pre></div>
				<p>
					Each strategy also has a <tt>maxBatchSize</tt> property to control the number of statements to execute at a time.
				</p>
				<p>e.g.</p>
<div class="source"><pre class="prettyprint linenums">
&lt;sync id=&quot;full&quot; class=&quot;net.sf.hajdbc.sync.FullSynchronizationStrategy&quot;&gt;
  &lt;property name=&quot;maxBatchSize&quot;&gt;50&lt;/property&gt;
&lt;/sync&gt;
</pre></div>
			<p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="session-failover">How can HA-JDBC be leveraged to improve database-driven HTTP Session failover?</a></dt><dd>
				<p>
					Several session replication methods are described in an <a class="externalLink" href="http://www.theserverside.com/articles/article.tss?l=J2EEClustering">article</a> posted to TheServerSide.com.
					Figure 7 illustrates the database persistence approach.
					When describing the disadvantages of this approach, the article fails to mention that the session database is a single point of failure in this design.
					HTTP sessions will survive the failure of an application server node, but failure of the session database spells doom for the application.
				</p>
				<p>
					However, this can easily remedied with redundant session databases using the HA-JDBC driver in distributable mode.
				</p>
				<p>e.g.</p>
				<p>
					For Tomcat, following the configuration instructions for setting up a Persistent Manager using a JDBC store <a class="externalLink" href="http://jakarta.apache.org/tomcat/tomcat-5.0-doc/config/manager.html">here</a>.
					Simply use HA-JDBC's driver and url in place of your database's JDBC driver and url for the <tt>driverName</tt> and <tt>connectionURL</tt> properties of your store configuration.
				</p>
			<p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="local-state-manager">HA-JDBC remembers which databases were inactive even after I restart my JVM.  Where is this state recorded and how do I clear it?</a></dt><dd>
				<p>
					HA-JDBC uses the Java preferences API to persist the local database cluster state.
					The default storage mechanism varies depending on your operating system.
				</p>
				<p>On Unix-like systems, the cluster state will be stored on the file system within the user's home directory:</p>
				<p><tt>~/.java/.userPrefs/net/sf/hajdbc/local/prefs.xml</tt></p>
				<p>On Windows systems, the cluster state will be stored in the registry:</p>
				<p><tt>HKEY_CURRENT_USER\Software\JavaSoft\Prefs\net\sf\hajdbc\local\</tt><i>cluster-name</i></p>
			<p align="right"><a href="#top">[top]</a></p><hr /></dd><dt><a name="authentication">
				Why does my application need to specify a username and password when making database connections through HA-JDBC when the necessary authentication information is already specified in its configuration file?
			</a></dt><dd>
				<p>
					The username and password set in the configuration file are only used by HA-JDBC when it needs to connect to a database independently of your application.  e.g. during synchronization, DatabaseCluster.isAlive() calls, etc.
					When your application connects to the database, the authentication information specified is passed through to the underlying driver.
				</p>
				<p>
					The purpose of this authentication pass-through is to retain the flexibility your application had without HA-JDBC to use an appropriate database user (with an appropriate set of permissions) for a given task.
					Traditionally, applications will use a database user with select/insert/update/delete privileges only.
					Some application may not need to write information to a database and can use a database user with select privileges only.
					The database user that is used by HA-JDBC should be more of a root/superuser, with specific abilities to drop and create indexes and foreign keys (used during synchronization).
				</p>
				<p>
					Since the same password will be passed through to each database, the user used by your application must exist and have the same password on each database in your cluster.
					The usernames/passwords used by HA-JDBC (as specified in the configuration file), however, do not need to be the same on each database.
				</p>
			<p align="right"><a href="#top">[top]</a></p></dd></dl></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2004-2012
                        <a href="https://github.com/pferraro">Paul Ferraro</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
